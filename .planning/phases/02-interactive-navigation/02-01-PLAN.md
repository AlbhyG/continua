---
phase: 02-interactive-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/components/layout/Header.tsx
autonomous: true

must_haves:
  truths:
    - "Clicking Who pill opens dropdown with 4 items (Individuals, Couples, Families, Teams)"
    - "Clicking What pill opens dropdown with 3 items (Take a Test, See Results, Tools and Actions)"
    - "Clicking Book pill opens dropdown with 3 items (Publishers, Agents, Therapists)"
    - "Opening one dropdown closes any other that was already open"
    - "Clicking outside an open dropdown closes it"
    - "Dropdown panels have glassmorphic styling (white 95% opacity, rounded corners, shadow, backdrop blur)"
    - "User can navigate dropdowns with keyboard (Tab to pill, Enter to open, Arrow keys to navigate items, Escape to close)"
    - "Who and What dropdown items navigate to their respective pages"
  artifacts:
    - path: "package.json"
      provides: "@headlessui/react dependency"
      contains: "@headlessui/react"
    - path: "src/components/layout/Header.tsx"
      provides: "Dropdown menus for Who, What, Book navigation pills"
      contains: "MenuButton"
  key_links:
    - from: "src/components/layout/Header.tsx"
      to: "@headlessui/react"
      via: "import { Menu, MenuButton, MenuItems, MenuItem }"
      pattern: "import.*Menu.*from.*@headlessui/react"
    - from: "src/components/layout/Header.tsx"
      to: "next/link"
      via: "Link components inside MenuItem for navigation"
      pattern: "MenuItem.*Link.*href"
---

<objective>
Install @headlessui/react and replace the three navigation pill buttons (Who, What, Book) with accessible dropdown menus using Headless UI Menu components. Each dropdown opens below its trigger pill with glassmorphic styling, supports full keyboard navigation, and handles click-outside-to-close automatically.

Purpose: Deliver the complete interactive navigation system (NAV-01 through NAV-06) so visitors can discover and navigate to content pages via dropdown menus.
Output: Working dropdown menus on all three navigation pills with accessibility and glassmorphic styling.
</objective>

<execution_context>
@/Users/shantam/.claude/get-shit-done/workflows/execute-plan.md
@/Users/shantam/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-interactive-navigation/02-RESEARCH.md
@.planning/phases/01-foundation-and-layout/01-02-SUMMARY.md
@src/components/layout/Header.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @headlessui/react and implement dropdown menus</name>
  <files>package.json, src/components/layout/Header.tsx</files>
  <action>
1. Install @headlessui/react:
   ```bash
   npm install @headlessui/react
   ```

2. In `src/components/layout/Header.tsx`, add imports at top:
   ```typescript
   import { Menu, MenuButton, MenuItems, MenuItem } from '@headlessui/react'
   ```
   Keep existing imports (Image, Link from next).

3. Define navigation data as constants INSIDE the file (above the component):
   ```typescript
   const whoItems = [
     { href: '/who', label: 'Individuals' },
     { href: '/who', label: 'Couples' },
     { href: '/who', label: 'Families' },
     { href: '/who', label: 'Teams' },
   ]

   const whatItems = [
     { href: '/what', label: 'Take a Test' },
     { href: '/what', label: 'See Results' },
     { href: '/what', label: 'Tools and Actions' },
   ]

   const bookItems = [
     { label: 'Publishers' },
     { label: 'Agents' },
     { label: 'Therapists' },
   ]
   ```
   Note: All Who items link to /who, all What items link to /what. Book items have NO href — they will trigger dialogs in Phase 4. For now, Book items are displayed in the dropdown but do nothing when clicked.

4. Replace the three pill `<button>` elements (Who, What, Book) with Headless UI Menu components. Keep the Sign In button as-is (it stays a plain button).

   For Who and What dropdowns (with navigation links):
   ```typescript
   <Menu>
     <MenuButton className="rounded-full bg-white/20 backdrop-blur px-4 py-1.5 text-sm font-bold text-white hover:bg-white/35 transition-colors">
       Who
     </MenuButton>
     <MenuItems
       anchor="bottom start"
       className="z-[100] mt-2 min-w-[200px] rounded-xl bg-white/95 backdrop-blur shadow-lg p-2"
     >
       {whoItems.map((item) => (
         <MenuItem key={item.label}>
           {({ focus }) => (
             <Link
               href={item.href}
               className={`block px-4 py-2 rounded-lg text-sm ${
                 focus ? 'bg-accent/10 text-accent' : 'text-gray-700'
               }`}
             >
               {item.label}
             </Link>
           )}
         </MenuItem>
       ))}
     </MenuItems>
   </Menu>
   ```

   For Book dropdown (no navigation, items are placeholder buttons):
   ```typescript
   <Menu>
     <MenuButton className="rounded-full bg-white/20 backdrop-blur px-4 py-1.5 text-sm font-bold text-white hover:bg-white/35 transition-colors">
       Book
     </MenuButton>
     <MenuItems
       anchor="bottom start"
       className="z-[100] mt-2 min-w-[200px] rounded-xl bg-white/95 backdrop-blur shadow-lg p-2"
     >
       {bookItems.map((item) => (
         <MenuItem key={item.label}>
           {({ focus }) => (
             <button
               type="button"
               className={`block w-full text-left px-4 py-2 rounded-lg text-sm ${
                 focus ? 'bg-accent/10 text-accent' : 'text-gray-700'
               }`}
             >
               {item.label}
             </button>
           )}
         </MenuItem>
       ))}
     </MenuItems>
   </Menu>
   ```

5. Glassmorphic styling on MenuItems panels (already specified in className above):
   - `bg-white/95` — white at 95% opacity
   - `backdrop-blur` — glassmorphism blur effect
   - `rounded-xl` — rounded corners
   - `shadow-lg` — elevated shadow
   - `p-2` — internal padding
   - `z-[100]` — above header's z-50 to prevent stacking issues

6. Do NOT modify the Sign In button — it stays as a plain `<button>` element.

7. Do NOT add any manual state management (useState, useEffect) for dropdown open/close — Headless UI handles this automatically including:
   - Only one dropdown open at a time
   - Click outside closes dropdown
   - Full keyboard navigation (Tab, Enter, Escape, Arrow keys)

8. Verify `npm run build` succeeds after changes.
  </action>
  <verify>
1. `npm run build` completes without errors
2. `grep -c "MenuButton" src/components/layout/Header.tsx` returns 3 (Who, What, Book)
3. `grep -c "MenuItems" src/components/layout/Header.tsx` returns 3
4. `grep "@headlessui/react" package.json` shows dependency exists
5. `grep "Sign In" src/components/layout/Header.tsx` confirms Sign In button still present as plain button
  </verify>
  <done>
- @headlessui/react installed in package.json
- Header.tsx has 3 Menu dropdowns (Who with 4 items, What with 3 items, Book with 3 items)
- Sign In remains a plain button
- Who items link to /who, What items link to /what, Book items are non-navigating buttons
- Dropdown panels have glassmorphic styling (bg-white/95, backdrop-blur, rounded-xl, shadow-lg)
- Build succeeds with no errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify dropdown accessibility and interaction behavior</name>
  <files>src/components/layout/Header.tsx</files>
  <action>
1. Start the dev server: `npm run dev`

2. Verify all 6 NAV requirements programmatically where possible:

   **NAV-01 (dropdown opens below trigger):**
   - Confirm MenuItems has `anchor="bottom start"` attribute in source

   **NAV-02 (only one open at a time):**
   - Confirm Headless UI Menu components are used (automatic behavior)
   - Verify no manual state management overrides this (no useState for open/close)

   **NAV-03 (click outside closes):**
   - Confirm Headless UI Menu components are used (automatic behavior)

   **NAV-04 (glassmorphic styling):**
   - Verify MenuItems className contains: bg-white/95, backdrop-blur, rounded-xl, shadow-lg

   **NAV-05 (items navigate):**
   - Verify Who dropdown items contain Link with href="/who"
   - Verify What dropdown items contain Link with href="/what"
   - Verify Book dropdown items are buttons (no href — Phase 4 will add dialog triggers)

   **NAV-06 (keyboard navigation):**
   - Confirm Headless UI Menu components are used (automatic: Tab, Enter, Escape, Arrows)
   - Verify no custom onKeyDown handlers that might interfere

3. Run `npm run lint` to ensure no linting issues.

4. Run `npm run build` one final time to confirm production build works.
  </action>
  <verify>
1. `npm run lint` passes
2. `npm run build` succeeds
3. Source code grep confirms: 3 MenuButton, 3 MenuItems, anchor="bottom start" on all MenuItems
4. Source code grep confirms: Link elements inside Who and What MenuItems, button elements inside Book MenuItems
5. No useState for dropdown state management in Header.tsx
  </verify>
  <done>
- All 6 NAV requirements verified through source analysis and build checks
- Lint passes clean
- Production build succeeds
- Headless UI provides automatic keyboard navigation (Tab, Enter, Escape, Arrow keys)
- Headless UI provides automatic only-one-open and click-outside-close behavior
  </done>
</task>

</tasks>

<verification>
1. `npm run build` — production build succeeds
2. `npm run lint` — no linting errors
3. Three Menu components in Header.tsx (one each for Who, What, Book)
4. Sign In button remains a plain button element
5. Glassmorphic classes present on all three MenuItems panels
6. Who dropdown: 4 items (Individuals, Couples, Families, Teams) linking to /who
7. What dropdown: 3 items (Take a Test, See Results, Tools and Actions) linking to /what
8. Book dropdown: 3 items (Publishers, Agents, Therapists) as non-navigating buttons
9. No manual state management for dropdowns (Headless UI handles automatically)
</verification>

<success_criteria>
- @headlessui/react is installed and used for all three dropdown menus
- Clicking any of Who/What/Book opens a glassmorphic dropdown panel below the trigger
- Only one dropdown can be open at a time (Headless UI automatic)
- Clicking outside closes the open dropdown (Headless UI automatic)
- Keyboard navigation works: Tab to pills, Enter/Space to open, Arrows to navigate, Escape to close (Headless UI automatic)
- Who and What items navigate to their pages, Book items are placeholder buttons
- Production build succeeds with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-interactive-navigation/02-01-SUMMARY.md`
</output>
